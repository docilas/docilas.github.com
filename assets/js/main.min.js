"use strict";$(function(){function e(){v=!device.mobile()&&!device.tablet()}function n(){C=$("#bg").height(),v&&(.5625*window.innerWidth<window.innerHeight?D.scale.set(window.innerHeight/.5625/1920):D.scale.set(.5625*window.innerWidth/1080),TweenMax.set(".work_list",{y:-C*(y+1)}))}function a(e,n){x=0,m=$(e+" img").length,TweenMax.to("#loading",.5,{autoAlpha:1}),TweenMax.set("#loading .progress",{width:"1%"}),$(e).imagesLoaded({background:!0}).always(function(){console.log("all images loaded"),TweenMax.to("#loading",.5,{autoAlpha:0,delay:.5,onComplete:function(){"function"==typeof n&&n()}})}).done(function(){console.log("all images successfully loaded")}).fail(function(){console.log("all images loaded, at least one is broken")}).progress(function(e,n){var a=n.isLoaded?"loaded":"broken";console.log("image is "+a+" for "+n.img.src),x++,TweenMax.to("#loading .progress",.3,{width:x/m*100+"%"})})}function o(){N.addChild(D,H,A,S),N.filters=[z],I.stage.addChild(N,W),I.ticker.add(function(){u+=v?.05:.01,W.rotation+=.005,W.scale.x=2+.2*Math.sin(u),W.scale.y=2+.2*Math.cos(u),"home"==T&&(S.scale.x=1+.003*Math.cos(u),S.scale.y=1+.006*Math.sin(u))}),TweenMax.fromTo("#bg canvas",1.5,{z:200},{z:d,alpha:1,ease:Sine.easeOut}),TweenMax.fromTo(S,1.5,{alpha:0},{alpha:1,delay:.25,ease:Sine.easeOut,onComplete:i}),TweenMax.set("html",{className:"+=init_done",delay:2.5})}function t(){$("html").hasClass("menu-open")?$("html").removeClass("menu-open"):$("html").addClass("menu-open")}function i(){E.restart()}function s(e){k=!0,T="worklist",TweenMax.set(".list_num",{className:"+=hide"}),"up"==e?(y--,g=$(".sec_work .work").eq(y),f=$(".sec_work .work").eq(y+1)):(y++,g=$(".sec_work .work").eq(y),f=$(".sec_work .work").eq(y-1)),TweenMax.to(".work_list",.75,{y:-C*(y+1),ease:Circ.easeInOut,onComplete:r}),0!==y&&window.innerWidth>768&&(TweenMax.fromTo(f.find(".masthead"),.5,{z:10},{z:-20,ease:Circ.easeOut}),TweenMax.fromTo(f.find(".info"),.5,{z:40},{z:-15,ease:Circ.easeOut})),$(".work_num").attr("data-num",y+1),f.removeClass("active"),g.addClass("active"),window.innerWidth>768&&(TweenMax.fromTo(g.find(".masthead"),.6,{z:-20},{z:10,delay:.5,ease:Circ.easeOut}),TweenMax.fromTo(g.find(".info"),.75,{z:-15},{z:40,delay:.6,ease:Circ.easeOut})),-1==y?(T="home",d=-10,TweenMax.to("#bg canvas",.5,{z:d,ease:Sine.easeOut}),TweenMax.set("#bg .tip",{className:"-=hide"}),E.restart()):(TweenMax.set(".list_num",{className:"-=hide",delay:.2}),TweenMax.set("#bg .tip",{className:"+=hide"}),0==y&&(d=v?-50:-10,TweenMax.to("#bg canvas",.5,{z:d,ease:Sine.easeOut}),TweenMax.set(".list_num",{className:"+=hide"}))),h=Math.abs(d/10)}function r(){k=!1}function c(){function e(){TweenMax.to("#mask .masthead",.5,{y:($("#mask .masthead")[0].offsetHeight-C)/2,delay:.25,ease:Circ.easeOut}),TweenMax.set("#mask",{className:"-=show work-"+(y+1),delay:.75}),TweenMax.set(".sec_work_inner",{className:"+=show work-"+(y+1),alpha:1,delay:.75})}window.innerWidth>768?TweenMax.fromTo("#mask .masthead",.5,{width:"83%",paddingTop:"37%"},{width:"100%",paddingTop:"30%",ease:Circ.easeOut,onComplete:e}):(TweenMax.set(".sec_work_inner",{className:"+=show work-"+(y+1)}),TweenMax.to(".sec_work_inner",.5,{alpha:1,delay:.1}))}function w(){function e(){TweenMax.set(".sec_work_inner",{className:"-=show work-"+(y+1)}),k=!1}window.innerWidth>768&&TweenMax.set("#mask .masthead",{width:"83%",paddingTop:"37%",y:"0"}),TweenMax.to(".sec_work_inner",.5,{alpha:0}),TweenMax.fromTo(".sec_work",.5,{alpha:0},{alpha:1,delay:.75,onComplete:e})}function l(e){var n=e.gamma/90,a=e.beta/90;"worklist"==T&&TweenMax.set("#bg canvas",{rotationX:5*-a/h,rotationY:5*n/h,x:10*-n/h+"%",y:10*-a/h+"%"})}var d=-10,h=Math.abs(d/10),u=0,x=void 0,m=void 0,p=7,y=-1,f=void 0,g=void 0,k=($(".sec_work .work").length,!1),T="home",M="",C=void 0,b=void 0,_=!1,v=void 0;e(),$.ajax({dataType:"json",url:"work_inner.json",success:function(e){b=e,_=!0}});var O={loading:function(){console.log("font loading")},active:function(){console.log("font active"),a("body",o)},google:{families:["Poppins:400,700"]}};WebFont.load(O);var I=new PIXI.Application(window.innerWidth,window.innerHeight);$("#bg").append(I.view);var N=new PIXI.Container,W=PIXI.Sprite.fromImage("assets/images/filter.png"),z=new PIXI.filters.DisplacementFilter(W);W.anchor.set(.5),W.position={x:I.renderer.width/2,y:I.renderer.height/2};var D=PIXI.Sprite.fromImage("assets/images/bg.jpg");n(),D.anchor.set(.5),D.position={x:I.renderer.width/2,y:I.renderer.height/2};var X=window.innerWidth<1e3?"CHIH\nYUAN\nKUO":"CHIH YUAN KUO",P=void 0;P=window.innerWidth>1366?150:window.innerWidth>480?100:80;var S=new PIXI.Text(X,{fontWeight:700,fontSize:P,fontFamily:"Poppins",fill:"#333",align:"center",strokeThickness:0});S.anchor.set(.5),S.blendMode=PIXI.BLEND_MODES.ADD,S.position={x:I.renderer.width/2,y:I.renderer.height/2};var H=new PIXI.Text(X,{fontWeight:700,fontSize:P,fontFamily:"Poppins",fill:"#FC577D",align:"center",strokeThickness:0});H.anchor.set(.5),H.blendMode=PIXI.BLEND_MODES.ADD,H.position={x:I.renderer.width/2,y:I.renderer.height/2},H.alpha=0;var A=new PIXI.Text(X,{fontWeight:700,fontSize:P,fontFamily:"Poppins",fill:"#54F3B7",align:"center",strokeThickness:0});A.anchor.set(.5),A.blendMode=PIXI.BLEND_MODES.ADD,A.position={x:I.renderer.width/2,y:I.renderer.height/2},A.alpha=0;var E=new TimelineMax({repeat:1,repeatDelay:.1,paused:!0});if(E.to(H,.05,{alpha:.4,x:S.x-p,y:S.y+p,ease:Circ.easeOut}).to(A,.05,{alpha:.4,x:S.x+p,y:S.y-p,ease:Circ.easeOut},"-=.05").to(H,.05,{x:S.x-p,y:S.y-p,ease:Circ.easeOut}).to(A,.05,{x:S.x+p,y:S.y+p,ease:Circ.easeOut},"-=.05").to(H,.05,{x:S.x+p,y:S.y+p,ease:Circ.easeOut}).to(A,.05,{x:S.x-p,y:S.y-p,ease:Circ.easeOut},"-=.05").to(H,.05,{x:S.x+p,y:S.y-p,ease:Circ.easeOut}).to(A,.05,{x:S.x-p,y:S.y+p,ease:Circ.easeOut},"-=.05").to(H,.05,{x:S.x,y:S.y,ease:Circ.easeOut}).to(A,.05,{x:S.x,y:S.y,ease:Circ.easeOut},"-=.05").to(H,.05,{x:S.x-p,y:S.y+p,ease:Circ.easeOut},"+=.2").to(A,.05,{x:S.x+p,y:S.y-p,ease:Circ.easeOut},"-=.05").to(H,.05,{x:S.x-p,y:S.y-p,ease:Circ.easeOut}).to(A,.05,{x:S.x+p,y:S.y+p,ease:Circ.easeOut},"-=.05").to(H,.05,{x:S.x+p,y:S.y+p,ease:Circ.easeOut}).to(A,.05,{x:S.x-p,y:S.y-p,ease:Circ.easeOut},"-=.05").to(H,.05,{x:S.x+p,y:S.y-p,ease:Circ.easeOut}).to(A,.05,{x:S.x-p,y:S.y+p,ease:Circ.easeOut},"-=.05").to(H,.05,{x:S.x,y:S.y,alpha:.1,ease:Circ.easeOut}).to(A,.05,{x:S.x,y:S.y,alpha:.1,ease:Circ.easeOut},"-=.05"),$(window).resize(n),$("#menu-trigger").on("click",t),$("#menu .btn").on("click",t),v){new WheelIndicator({callback:function(e){if(!k&&"about"!==T&&"workinner"!==T){if("up"==e.direction&&-1==y)return!1;if("down"==e.direction&&y==$(".sec_work .work").length-1)return!1;s(e.direction)}},preventMouse:!1});$("body").on("mousemove",function(e){var n=e.clientX/window.innerWidth-.5,a=e.clientY/window.innerHeight-.5;TweenMax.to("#bg canvas",.5,{rotationX:7*-a/h,rotationY:7*n/h,x:10*-n/h+"%",y:10*-a/h+"%"}),"worklist"==T&&(TweenMax.to(g.find(".masthead"),.75,{rotationX:5*-a,rotationY:5*n,x:5*-n+"%",y:5*-a+"%"}),TweenMax.to(g.find(".info"),1,{rotationX:7*-a,rotationY:7*n,x:10*-n+"%",y:10*-a+"%"}))})}else{var F=new Hammer($(".sec_work")[0]);F.get("swipe").set({direction:Hammer.DIRECTION_VERTICAL}),F.on("swipeup swipedown",function(e){return!k&&"about"!==T&&"workinner"!==T&&(("swipedown"!=e.type||-1!=y)&&(("swipeup"!=e.type||y!=$(".sec_work .work").length-1)&&void s("swipeup"==e.type?"down":"up")))}),window.addEventListener("deviceorientation",l)}$(".btn-work").on("click",function(){"worklist"!==T&&s("down")}),$(".btn-home").on("click",function(){k||(y=0,s("up"))}),$(".btn-about").on("click",function(){M=T,T="about",TweenMax.set(".sec_about",{className:"+=show"}),TweenMax.to(".sec_about ",.6,{alpha:1,ease:Sine.easeOut}),TweenMax.to(".sec_about .wrapper",.5,{x:"0%",delay:.2,ease:Circ.easeOut})}),$(".close-about").on("click",function(){T=M,TweenMax.to(".sec_about ",.3,{alpha:0,delay:.1,ease:Circ.easeOut}),TweenMax.to(".sec_about .wrapper",.5,{x:"-20%"}),TweenMax.set(".sec_about",{className:"-=show",delay:.55,ease:Circ.easeOut})}),$(".btn-discover").on("click",function(){_&&(M=T,T="workinner",$(".sec_work_inner .inner").html(b["work-"+(y+1)]),a(".sec_work_inner",c),TweenMax.to(".sec_work",.3,{alpha:0}),window.innerWidth>768&&TweenMax.set("#mask",{className:"+=show work-"+(y+1)}))}),$(".close-workinner").on("click",function(){T=M,k=!0,w()})});