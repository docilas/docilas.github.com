"use strict";function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}$(function(){function e(){d.setPosition(N,{x:850,y:1100})}function t(){d.setVelocity(N,{x:0,y:-30-30*Math.random()})}var n=Matter.Engine,r=Matter.Render,i=Matter.Runner,o=(Matter.Composite,Matter.Composites),a=Matter.Constraint,s=Matter.MouseConstraint,u=Matter.Mouse,l=Matter.World,c=Matter.Vertices,f=(Matter.Vector,Matter.Svg),d=Matter.Body,p=Matter.Bounds,h=Matter.Bodies,g=Matter.Events,v=document.getElementById("stage"),y=n.create(),m=y.world,x=r.create({canvas:v,engine:y,options:{width:window.innerWidth,height:window.innerHeight,background:"transparent",enabled:!0,wireframes:!0,hasBounds:!0,showSleeping:!1,showBounds:!1,showAxes:!0,showPositions:!0,showAngleIndicator:!0,showVelocity:!0}});r.run(x);var b=i.create();i.run(b,y),$.get("assets/images/wrap.svg").done(function(e){var t=[];$(e).find("path").each(function(e,n){var r=f.pathToVertices(n);t.push(c.scale(r,1,1.2))}),l.add(m,h.fromVertices(443,70,t,{isStatic:!0,render:{fillStyle:"transparent",lineWidth:1,opacity:.5}}))});var w=o.stack(82,1e3,9,1,72,0,function(e,t){return h.rectangle(e,t,10,200,{isStatic:!0})}),S=o.stack(10,1050,10,1,10,0,function(e,t,n){return h.rectangle(e,t,72,150,{isStatic:!0,isSensor:!0,render:{fillStyle:"transparent"},sid:"sensor"+n})}),C={};S.bodies.map(function(e){C[e.sid]="answer"});for(var T=o.stack(100,330,5,2,80,160,function(e,t){var n=360*Math.random(),r=h.rectangle(e,t,50,10,{angle:n}),i=h.rectangle(e,t,10,50,{render:r.render,angle:n});return d.create({parts:[r,i],isStatic:!1})}),A=o.stack(30,450,5,2,80,160,function(e,t){var n=360*Math.random(),r=h.rectangle(e,t,50,10,{angle:n}),i=h.rectangle(e,t,10,50,{render:r.render,angle:n});return d.create({parts:[r,i],isStatic:!1})}),k=[],P=0;P<T.bodies.length;P++){var E=a.create({pointA:{x:T.bodies[P].position.x,y:T.bodies[P].position.y},bodyB:T.bodies[P],pointB:{x:0,y:0}});k.push(E)}for(var P=0;P<A.bodies.length;P++){var E=a.create({pointA:{x:A.bodies[P].position.x,y:A.bodies[P].position.y},bodyB:A.bodies[P],pointB:{x:0,y:0}});k.push(E)}var _=[].concat(_toConsumableArray(T.bodies),_toConsumableArray(A.bodies));_.forEach(function(e){e.density=2,e.restitution=4});var N=h.circle(850,1e3,27.5);N.density=1,N.restitution=.2,N.friction=.01,N.frictionStatic=.01,l.add(m,[h.rectangle(450,0,900,20,{isStatic:!0}),h.rectangle(450,1200,900,20,{isStatic:!0}),h.rectangle(900,600,20,1200,{isStatic:!0}),h.rectangle(0,600,20,1200,{isStatic:!0}),h.rectangle(825,800,10,800,{isStatic:!0}),w,S,T,A].concat(k,[N]));var j=u.create(x.canvas),L=s.create(y,{mouse:j,constraint:{stiffness:1,render:{visible:!1}}});l.add(m,L),x.mouse=j;g.on(y,"collisionStart",function(e){for(var t=e.pairs,n=0,r=t.length;n!=r;++n){var i,o=t[n];(o.bodyA.sid||o.bodyB.sid)&&(i=o.bodyA?o.bodyA:o.bodyB,console.log(i.sid))}});var D={x:.5*x.options.width,y:.5*x.options.height};g.on(b,"tick",function(){p.shift(x.bounds,{x:N.position.x-D.x,y:N.position.y-D.y})}),$("canvas").on("click",t),window.addEventListener("keydown",function(t){82===t.keyCode&&e()})});